<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="app_title">AIDE RAP</title>
    <link rel="manifest" href="/manifest.json">
    <link rel="stylesheet" href="/static/frame/css/base.css">
    <link rel="stylesheet" href="/static/rap/rap.css">
</head>
<body>
    <div class="app-container page-fill">
        <!-- Framework Header Widget -->
        <div id="app-header"></div>

        <!-- Menu Bar for RAP-specific navigation -->
        <nav id="rap-menu-bar" class="rap-menu-bar">
            <a href="/about?doc=requirements/DataModel.md" class="menu-item" data-i18n="data_model">Model</a>
            <a href="/layout-editor" class="menu-item" data-i18n="layout_editor">Layout</a>
            <a href="/rap" class="menu-item" data-i18n="rap_docs">RAP Docs</a>
            <span class="menu-separator">|</span>
            <label class="menu-label" data-i18n="menu_sort">Sort:</label>
            <select id="sort-attributes" class="menu-select" title="Attribute order" data-i18n-title="tooltip_attr_order">
                <option value="schema" data-i18n="sort_attr_schema">Schema</option>
                <option value="alpha" data-i18n="sort_attr_alpha">ABC</option>
            </select>
            <select id="sort-references" class="menu-select" title="References position" data-i18n-title="tooltip_ref_position">
                <option value="end" data-i18n="sort_ref_end">References at end</option>
                <option value="start" data-i18n="sort_ref_start">References first</option>
                <option value="inline" data-i18n="sort_ref_inline">References inline</option>
            </select>
            <span class="menu-separator">|</span>
            <label class="menu-checkbox" title="Show technical IDs in detail panel" data-i18n-title="tooltip_show_ids">
                <input type="checkbox" id="show-ids-toggle">
                <span>IDs</span>
            </label>
            <label class="menu-checkbox" title="Show cycle references (otherwise hidden)" data-i18n-title="tooltip_show_cycles">
                <input type="checkbox" id="show-cycles-toggle">
                <span style="font-size: 1.1em;">&#x21bb;</span>
            </label>
            <label class="menu-checkbox" title="Show timestamps and version" data-i18n-title="tooltip_show_system">
                <input type="checkbox" id="show-system-toggle">
                <span style="font-size: 1.1em;">&#x25F7;</span>
            </label>
            <span class="menu-separator">|</span>
            <a href="#" id="menu-tools" class="menu-item" data-i18n="menu_admin">Admin</a>
        </nav>

        <!-- Modal Container (for Seed Manager and other tools) -->
        <div id="modal-container"></div>

        <!-- Main Content Area -->
        <main class="main-content">
            <div class="content-split">
                <!-- Entity Explorer (left) -->
                <section id="entity-explorer" class="entity-explorer">
                    <!-- Toolbar -->
                    <div class="explorer-toolbar">
                        <!-- View mode toggle: Table / Tree-H / Tree-V -->
                        <div class="view-mode-buttons">
                            <button id="btn-view-table" class="btn-view-mode" title="Table view" data-i18n-title="tooltip_table_view">
                                <!-- Grid/Table icon -->
                                <svg width="14" height="14" viewBox="0 0 14 14" fill="currentColor">
                                    <rect x="0" y="0" width="6" height="3"/><rect x="8" y="0" width="6" height="3"/>
                                    <rect x="0" y="5" width="6" height="3"/><rect x="8" y="5" width="6" height="3"/>
                                    <rect x="0" y="10" width="6" height="3"/><rect x="8" y="10" width="6" height="3"/>
                                </svg>
                            </button>
                            <button id="btn-view-tree-h" class="btn-view-mode" title="Tree view (horizontal attributes)" data-i18n-title="tooltip_tree_view_h">
                                <!-- Tree with horizontal bars -->
                                <svg width="14" height="14" viewBox="0 0 14 14" fill="currentColor">
                                    <rect x="0" y="0" width="14" height="2"/>
                                    <rect x="2" y="4" width="12" height="2"/>
                                    <rect x="4" y="8" width="5" height="2"/><rect x="10" y="8" width="4" height="2"/>
                                    <rect x="4" y="12" width="10" height="2"/>
                                </svg>
                            </button>
                            <button id="btn-view-tree-v" class="btn-view-mode active" title="Tree view (vertical attributes)" data-i18n-title="tooltip_tree_view_v">
                                <!-- Tree with vertical bar indicating stacked layout -->
                                <svg width="14" height="14" viewBox="0 0 14 14" fill="currentColor">
                                    <rect x="0" y="0" width="14" height="2"/>
                                    <rect x="2" y="4" width="2" height="10"/>
                                    <rect x="6" y="12" width="8" height="2"/>
                                </svg>
                            </button>
                        </div>
                        <div id="view-selector" class="view-selector-dropdown" style="display:none">
                            <button class="view-selector-trigger">
                                <span class="view-selector-text">Views</span>
                            </button>
                            <div class="view-selector-menu"></div>
                        </div>
                        <div id="entity-selector" class="entity-selector-dropdown">
                            <button class="entity-selector-trigger">
                                <span class="entity-selector-text" data-i18n="select_entity">Select Entity...</span>
                            </button>
                            <div class="entity-selector-menu"></div>
                        </div>
                        <button id="btn-refresh-counts" class="btn-icon" title="Refresh counts" data-i18n-title="tooltip_refresh_counts">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M23 4v6h-6M1 20v-6h6"/>
                                <path d="M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15"/>
                            </svg>
                        </button>
                    </div>

                    <!-- Entity Table (table view) -->
                    <div id="entity-table-container" class="entity-list hidden">
                    </div>

                    <!-- Entity Tree (tree view) -->
                    <div id="entity-tree-container" class="entity-list">
                    </div>
                </section>

                <!-- Detail Panel (right) -->
                <aside id="detail-panel" class="detail-panel">
                    <div class="panel-header">
                        <span id="panel-title" class="panel-title" data-i18n="details">Details</span>
                        <button id="panel-toggle" class="panel-toggle" title="Collapse panel" data-i18n-title="tooltip_collapse_panel">&#9666;</button>
                    </div>
                    <div id="panel-content" class="panel-content">
                        <p class="empty-message" data-i18n="select_record_message">Select a record to view details.</p>
                    </div>
                </aside>

                <!-- Collapsed Panel Toggle -->
                <button id="panel-expand" class="panel-expand hidden" title="Expand panel" data-i18n-title="tooltip_expand_panel">&#9656;</button>
            </div>

            <!-- Framework Status Widget (Footer) -->
            <div id="status-widget" class="status-widget"></div>
        </main>
    </div>

    <!-- Conflict Dialog Template (OCC) -->
    <dialog id="conflict-dialog" class="conflict-dialog">
        <div class="dialog-content">
            <h3 id="conflict-title" data-i18n="conflict_title">Version Conflict</h3>
            <p class="conflict-message" data-i18n="conflict_message">
                This record was modified by another user. Please review the changes:
            </p>
            <div id="conflict-diff" class="conflict-diff"></div>
            <div class="dialog-buttons">
                <button id="conflict-cancel" class="btn-secondary" data-i18n="cancel">Cancel</button>
                <button id="conflict-reload" class="btn-primary" data-i18n="reload_changes">Load Server Version</button>
                <button id="conflict-overwrite" class="btn-danger" data-i18n="overwrite">Overwrite</button>
            </div>
        </div>
    </dialog>

    <!-- Confirm Dialog Template -->
    <dialog id="confirm-dialog" class="confirm-dialog">
        <div class="dialog-content">
            <p id="confirm-message"></p>
            <label class="checkbox-row" id="confirm-remember-row">
                <input type="checkbox" id="confirm-remember">
                <span data-i18n="dont_ask_again">Don't ask again this session</span>
            </label>
            <div class="dialog-buttons">
                <button id="confirm-cancel" class="btn-secondary" data-i18n="cancel">Cancel</button>
                <button id="confirm-ok" class="btn-danger" data-i18n="delete">Delete</button>
            </div>
        </div>
    </dialog>

    <!-- Framework Scripts -->
    <script src="/static/frame/vendor/polyglot/polyglot.min.js"></script>
    <script src="/static/frame/js/i18n.js"></script>
    <script src="/static/frame/js/google-translate.js"></script>
    <script src="/static/frame/js/header-widget.js"></script>
    <script src="/static/frame/js/status-widget.js"></script>
    <script src="/static/frame/js/pwa.js"></script>

    <!-- RAP Scripts -->
    <script src="/static/rap/utils/DomUtils.js"></script>
    <script src="/static/rap/utils/ColumnUtils.js"></script>
    <script src="/static/rap/services/api-client.js"></script>
    <script src="/static/rap/components/context-menu.js"></script>
    <!-- Entity Tree modules (must load before entity-tree.js) -->
    <script src="/static/rap/components/entity-tree-state.js"></script>
    <script src="/static/rap/components/entity-tree-renderer.js"></script>
    <script src="/static/rap/components/entity-tree-pdf.js"></script>
    <script src="/static/rap/components/entity-tree.js"></script>
    <script src="/static/rap/components/entity-table.js"></script>
    <script src="/static/rap/components/entity-explorer.js"></script>
    <script src="/static/rap/components/detail-panel.js"></script>
    <script src="/static/rap/components/media-upload.js"></script>
    <script src="/static/rap/components/media-browser.js"></script>
    <script src="/static/rap/components/entity-form.js"></script>
    <script src="/static/rap/components/conflict-dialog.js"></script>
    <script src="/static/rap/utils/CsvParser.js"></script>
    <script src="/static/rap/components/seed-import-dialog.js"></script>
    <script src="/static/rap/components/seed-preview-dialog.js"></script>
    <script src="/static/rap/components/seed-manager.js"></script>
    <script src="/static/rap/components/seed-generator-dialog.js"></script>
    <script src="/static/rap/components/model-builder-dialog.js"></script>
    <script src="/static/rap/components/login-dialog.js"></script>
    <script src="/static/rap/rap.js"></script>
</body>
</html>
